import pandas as pd

# 假设A是包含保留行号的列表（Excel实际行号）
A = [11,91,41,26,80,
90,
80,
7,
33,
87,
44,
85,
57,
22,
96,
43,
41,
45,
61,
12,
23,
2,
50,
56,
37,
12,
87,
89,
80,
2,
21,
7,
90,
26,
80,
45,
26,
85,
61,
37,
43,
37,
80,
19,
64,
46,
30,
30,
30,
30,
30,
30,
30,
64,
89,
43,
22,
1,
21,
9,
26,
87,
87,
12,
7,
7,
12,
87,
80,
87,
7,
44,
7,
61,
61,
61,
61,
50,
50,
50,
12,
13,
3,
85,
45,
2,
22,
3,
2,
80,
23,
57,
82,
63,
22,
22,
66,
63,
64,
10,
40,
57,
87,
50,
66,
58,
21,
61,
22,
88,
87,
30,
30,
3,
20,
20,
30,
50,
82,
63,
91,
9,
54,
90,
88,
22,
22,
63,
60,
10,
90,
37,
33,
43,
61,
12,
13,
9,
96,
22,
85,
18,
80,
89,
12,
49,
54,
64,
85,
57,
82,
3,
23,
40,
64,
12,
60,
89,
85,
12,
96,
21,
49,
54,
13,
87,
7,
20,
20,
10,
49,
21,
54,
46,
89,
1,
46,
87,
88,
11,
42,
82,
1,
3,
12,
26,
64,
60,
85,
1,
40,
42,
2,
89,
43,
22,
33,
18,
91,
90,
19,
90,
54,
12,
7,
41,
18,
23,
88,
42,
42,
42,
22,
88,
88,
88,
88,
60,
9,
60,
60,
41,
41,
87,
33,
87,
87,
12,
43,
87,
43,
87,
85,
11,
44,
13,
23,
19,
37,
88,
85,
22,
44,
58,
22,
45,
26,
56,
60,
9,
21,
89,
96,
11,
96,
87,
58,
81,
7,
56,
56,
56,
56,
13,
91,
40,
21,
80,
89,
37,
13,
42,
23,
19,
2,
33,
90,
54,
44,
11,
80,
87,
49,
26,
91,
12,
22,
85,
21,
50,
90,
12,
33,
3,
1,
1,
66,
46,
20,
10,
12,
10,
64,
66,
46,
20,
12,
33,
60,
50,
21,
49,
80,
85,
22,
43,
13,
9,
80,
3,
1,
61,
46,
14,
9,
3,
30,
22,
2,
88,
19,
85,
87,
12,
40,
7,
12,
42,
26,
26,
42,
60,
21,
23,
22,
43,
85,
96,
37,
45,
87,
54,
22,
43,
2,
91,
22,
96,
21,
33,
89,
22,
66,
20,
30,
49,
2,
54,
90,
50,
22,
7,
87,
33,
60,
11,
66,
20,
56,
3,
60,
10,
80,
37,
12,
80,
40,
80,
58,
85,
26,
9,
12,
7,
66,
10,
20,
30,
22,
96,
43,
22,
37,
80,
91,
91,
80,
87,
54,
43,
22,
44,
66,
22,
80,
22,
13,
50,
42,
2,
87,
57,
12,
61,
64,
85,
40,
90,
45,
85,
87,
61,
23,
87,
96,
43,
45,
21,
54,
22,
89,
85,
60,
22,
46,
96,
37,
46,
88,
42,
49,
9,
88,
80,
80,
22,
43,
44,
21,
13,
96,
9,
26,
44,
60,
13,
37,
90,
60,
45,
63,
11,
9,
22,
22,
11,
43,
87,
54,
12,
90,
66,
85,
46,
22,
88,
88,
42,
20,
10,
14,
80,
20,
66,
10,
30,
14,
64,
20,
10,
43,
66,
66,
33,
11,
87,
57,
2,
21,
26,
43,
80,
87,
82,
61,
43,
87,
87,
80,
80,
90,
80,
90,
80,
3,
85,
22,
63,
23,
7,
57,
49,
80,
80,
43,
40,
80,
56,
49,
87,
43,
46,
45,
49,
43,
41,
85,
63,
22,
26,
13,
63,
11,
18,
41,
91,
90,
33,
21,
26,
9,
80,
56,
22,
80,
56,
80,
88,
12,
14,
12,
30]
B = set(range(1,97)) - set(A)  # 生成要删除的行号集合

# 读取原始数据（保留所有行）
df = pd.read_excel(r"E:\github\new-productivity\criterion\file.xlsx",
                  sheet_name='参考文献',
                  header=0)

# 过滤行（通过索引计算）
filtered_df = df[~df.index.isin([x-1 for x in B])]  # 将Excel行号转换为pandas索引

# 保存到新sheetr"E:\github\new-productivity\criterion\file_1.xlsx"
filtered_df.to_excel(r"E:\github\new-productivity\criterion\file_1.xlsx",
                     sheet_name='reference_new',
                     index=False)

print(f"已创建新表reference_new，保留{A}指定的{len(A)}行数据")
